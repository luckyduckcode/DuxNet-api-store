# Create a minimal valid ICO file
$icoData = @(
    0x00, 0x00,  # Reserved
    0x01, 0x00,  # Type (1 = ICO)
    0x01, 0x00,  # Number of images
    0x10, 0x00,  # Width (16)
    0x10, 0x00,  # Height (16)
    0x00,        # Color count
    0x00,        # Reserved
    0x01, 0x00,  # Color planes
    0x20, 0x00,  # Bits per pixel
    0x68, 0x04, 0x00, 0x00,  # Size of image data
    0x16, 0x00, 0x00, 0x00   # Offset to image data
)

# Add PNG header and minimal PNG data
$pngData = @(
    0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A,  # PNG signature
    0x00, 0x00, 0x00, 0x0D, 0x49, 0x48, 0x44, 0x52,  # IHDR chunk
    0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x10,  # Width/Height
    0x08, 0x02, 0x00, 0x00, 0x00, 0x90, 0x91, 0x68,  # Bit depth, color type, etc.
    0x36, 0x00, 0x00, 0x00, 0x0C, 0x49, 0x44, 0x41,  # IDAT chunk
    0x54, 0x78, 0x9C, 0x63, 0x00, 0x00, 0x00, 0x02,  # Minimal compressed data
    0x00, 0x01, 0xE5, 0x27, 0xDE, 0xFC, 0x00, 0x00,  # IEND chunk
    0x00, 0x00, 0x49, 0x45, 0x4E, 0x44, 0xAE, 0x42, 0x60, 0x82
)

# Combine header and PNG data
$fullData = $icoData + $pngData

# Write to file
[System.IO.File]::WriteAllBytes("icons\icon.ico", $fullData)

Write-Host "Minimal ICO file created successfully!" 